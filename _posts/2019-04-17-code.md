---
layout: post
title: Code
img: seg.png # Add image post (optional)
permalink: code
---

---

## Executing The Code
This code was written to be executed in a particular file structure, diagrammed
as follows:

With a GitHub account you can clone a repository with all data and code in
place in the correct directory structure. Please follow the installation
instructions on the [GitHub repository](http://www.github.com/rpgroup-pboc/mwc_mutants).

## The `mut` Module
This work required a moderate amount of home-grown code. To ensure
reproducibility, we have written it as a Python module that can be installed
from the master branch of the [GitHub
repository](http://wwww.github.com/rpgroup-pboc/mwc_mutants). Please see the
installation instructions for details. This module is required to execute all of
the following scripts.

## Figure Generation
All Figures in this work (save for Fig. 2) were generated
* [Fig. 1(C): Razo-Mejia et al. 2018 Data Collapse]({{site.baseurl}}/code/Chure2019_Fig1_collapse.py)<br/>
  Used to generate the data collapse figures shown in Fig. 1C of the main text.
  + Necessary Data Sets: 
    1. [Data from Razo-Mejia et al. 2018]({{site.baseurl}}/data/RazoMejia_2018.csv)

* [Fig. 3: DNA Binding Mutants]({{site.baseurl}}/code/Chure2019_Fig3_DNA_mutants.py)<br/>
  Used to generate Figure 3, illustrating DNA binding mutant data, induction
  profiles, data collapse and change in free energy. 
  + Necessary Data Sets: 
    1. [Summarized fold-change measurements]({{site.baseurl}}/data/Chure2019_summarized_data.csv)
    2. [DNA binding energy inference statistics]({{site.baseurl}}/data/Chure2019_DNA_binding_energy_summary.csv)
    3. [Free energy inferred from fold-change measurements]({{site.baseurl}}/data/Chure2019_empirical_F_statistics.csv) 

* [Fig. 4: Inducer Binding Domain Mutants]({{site.baseurl}}/code/Chure2019_Fig4_IND_mutants.py)<br/>
  Used to generate Figure 4, illustrating the inducer binding mutant data,
  induction profiles, data collapse, and change in free energy.
  + Necessary Data Sets:
    1. [Summarized fold-change measurements]({{site.baseurl}}/data/Chure2019_summarized_data.csv)
    2. [Ka and Ki inference statistics]({{site.baseurl}}/data/Chure2019_KaKi_only_summary.csv)
    3. [Allosteric parameter inference samples]({{site.baseurl}}/data/Chure2019_KaKi_epAI_samples.csv) 
    4. [Free energy inferred from fold-change measurements]({{site.baseurl}}/data/Chure2019_empirical_F_statistics.csv) 

* [Fig. 5: Double Mutants]({{site.baseurl}}/code/Chure2019_Fig5_DBL_mutants.py)<br/>
  Used to generate Figure 5, illustrating the double mutant data, induction
  profiles, and change in free energy. 
  + Necessary Data Sets:
    1. [Summarized fold-change measurements]({{site.baseurl}}/data/Chure2019_summarized_data.csv)
    2. [Allosteric parameter inference samples]({{site.baseurl}}/data/Chure2019_KaKi_epAI_samples.csv) 
    3. [DNA binding energy inference samples]({{site.baseurl}}/data/Chure2019_DNA_binding_energy_samples.csv)
    4. [Free energy inferred from fold-change measurements]({{site.baseurl}}/data/Chure2019_empirical_F_statistics.csv) 

* [Fig. 6: Data Collapse of the Inducible Simple Repression Motif]({{site.baseurl}}/code/Chure2019_Fig6_data_collapse.py)
  Used to generate Figure 6, illustrating full data collapse of previous
  measurements from Garcia and Phillips 2011, Brewster et al. 2014, Razo-Mejia
  et al. 2018, and this work.
  + Necessary Data Sets:
    1. [Summarized fold-change measurements]({{site.baseurl}}/data/Chure2019_summarized_data.csv)
    2. [DNA binding energy inference statistics]({{site.baseurl}}/data/Chure2019_DNA_binding_energy_summary.csv),
    3. [Allosteric parameter inference statistics]({{site.baseurl}}/data/Chure2019_KaKi_epAI_samples.csv) 
    4. [Data from Garcia and Phillips 2011 and Brewster et al. 2014]({{site.baseurl}}/data/Garcia2011_Brewster2014.csv)
    5. [Data from Razo-Mejia et al. 2018]({{site.baseurl}}/data/RazoMejia_2018.csv)

## Inferential Models
All parameter inference was performed using the [Stan probabilistic programming
language](http://mc-stan.org). The following Stan model files perform the
described analysis. 

* [Inference of DNA Binding Energy]({{site.baseurl}}/code/Chure2019_DNA_binding_energy.stan)<br/>
  Used to estimate the DNA binding energy and homoscedastic error for a single
  induction profile. 

* [Inference of Inducer Dissociation Constants]({{site.baseurl}}/code/Chure2019_KaKi_only.stan)<br/>
  Used to estimate the inducer dissociation constants Ka and Ki for a single
  induction profile, assuming the allosteric energy difference is unperturbed from the wild-type value.

* [Inference of Allosteric Parameters]({{site.baseurl}}/code/Chure2019_KaKi_epAI.stan)<br/>
  Used to infer the inducer dissociation constants Ka and Ki along with the
  allosteric energy difference for a single induction profile.

* [Inference of Free Energy from Fold-Change Measurements]({{site.baseurl}}/code/Chure2019_empirical_F_inference.stan)<br/>
  Used to infer the mean fold-change, standard deviation, and free energy for a
  collection of fold-change measurements. 

## Data Generation and Processing
The following scripts were used to execute the inference models and generate
simulated data sets used in the supplemental information. 

* [Execution of parameter inference models]({{site.baseurl}}/code/Chure2019_parameter_inference.py)<br/>
  Loads the data, calls the inferential models, and save statistics and samples
  to tidy `.csv` files. 
  + Necessary Data Sets:
    1. [Compiled fold-change measurements]({{site.baseurl}}/code/Chure2019_compiled_data.csv)<br/>
  + Necessary Stan Models:
    1. [Inference of DNA Binding Energy]({{site.baseurl}}/code/Chure2019_DNA_binding_energy.stan)<br/>
    2. [Inference of Inducer Dissociation Constants]({{site.baseurl}}/code/Chure2019_KaKi_only.stan)<br/>
    3. [Inference of Allosteric Parameters]({{site.baseurl}}/code/Chure2019_KaKi_epAI.stan)<br/>

* [Example Processing Script]({{site.baseurl}}/code/Chure2019_flow_processing.py)
  An representative Python script used to process a collection of flow cytometry
  files. 

## Supplementary Materials
The following code was used to generate the supplementary figures as well as any
data generated via simulation.

* [Fig. S2: Prior Predictive Checks for DNA Binding Energy and Homoscedastic Error]({{site.baseurl}}/code/Chure2019_FigS2_epRA_prior_predictive.py)
  Used to generate Figure S2 illustrating the prior distributions for the DNA
  binding energy and homoscedastic error as well as visualize the percentiles of
  the prior predictive checks. 
  + Necessary Data Sets and Auxiliary Scripts:
    1. [DNA binding energy prior predictive check data (`.csv`)]({{site.baseurl}}/data/Chure2019_DNA_prior_predictive_samples.csv)
    2. [DNA binding energy prior predictive check generation (`.py`)]({{site.baseurl}}/code/Chure2019_DNA_prior_predictive_samples.py)

* [Fig. S3: Prior Distribution Recovery for DNA Binding Energy and Homoscedastic
  Error]({{site.baseurl}}/code/Chure2019_FigS3_epRA_sensitivity_parameters)
  Used to generate Figure S3 which shows that the prior distributions of the
  parameters can be recovered through repeated inferential runs on simulated
  data.
  + Necessary Data Sets and Auxiliary Scripts:
    1. [DNA binding energy prior predictive check data
       (`.csv.`)]({{site.baseurl}}/data/Chure2019_DNA_prior_predictive_samples.csv)
    2. [DNA binding energy simulation based calibration results
       (`.csv`)]({{site.baseurl}}/data/Chure2019_DNA_sbc_samples.csv)
    3. [DNA binding energy simulation based calibration generation
       (`.py`)]({{site.baseurl}}/code/Chure2019_DNA_sbc_samples.py)

* [Fig. S4: Z-scores and shrinkage parameters for DNA binding energy inference]({{site.baseurl}}/code/Chure2019_)